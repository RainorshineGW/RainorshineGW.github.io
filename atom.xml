<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>哎呀呀,小拳拳捶你胸口</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.assd.xyz/"/>
  <updated>2018-04-08T02:44:01.009Z</updated>
  <id>http://www.assd.xyz/</id>
  
  <author>
    <name>gw</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mysql更新和删除一些注意点</title>
    <link href="http://www.assd.xyz/2018/04/04/2/"/>
    <id>http://www.assd.xyz/2018/04/04/2/</id>
    <published>2018-04-04T09:42:53.413Z</published>
    <updated>2018-04-08T02:44:01.009Z</updated>
    
    <content type="html"><![CDATA[<h3 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h3><p>当update语句中,修改参数的值为实时查询出来的值，会报语法错误，譬如如下语法:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> a <span class="keyword">SET</span> age=<span class="keyword">SELECT</span> age <span class="keyword">FROM</span> b <span class="keyword">WHERE</span> <span class="string">`name`</span>=<span class="string">'lisi'</span> <span class="keyword">WHERE</span> age&lt;<span class="number">2</span></span><br></pre></td></tr></table></figure></p><font size="1.5px" color="red"><br>报的错为:[Err] 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘SELECT age FROM b WHERE <code>name</code>=’lisi’ WHERE age&lt;2’ at line 1<br></font><p>如要实现上述需求语法则可以这样写，UPDATE的时候连接另外一张表，连接的时候过滤取得我们需要的数据然后可以直接SET a.age = b.age了</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> a <span class="keyword">AS</span> ta <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> b <span class="keyword">WHERE</span> age = <span class="number">11</span>) <span class="keyword">AS</span> tb <span class="keyword">SET</span> ta.age=tb.age <span class="keyword">WHERE</span> ta.<span class="string">`name`</span>=<span class="string">'zhangsan'</span></span><br></pre></td></tr></table></figure><h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><p>当删除语句条件采用子查询为条件的话,mysql会报语法错误,<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> a <span class="keyword">WHERE</span> <span class="string">`name`</span> = <span class="keyword">SELECT</span> <span class="string">`name`</span> <span class="keyword">FROM</span> b <span class="keyword">WHERE</span> <span class="string">`name`</span> = <span class="string">'lisi'</span></span><br></pre></td></tr></table></figure></p><p><font size="1.5px" color="red"><br>[Err] 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘SELECT <code>name</code> FROM b WHERE <code>name</code> = ‘lisi’’ at line 1<br></font><br>这是应为mysql不允许在子查询中使用要删除的表</p><h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> ta.* <span class="keyword">FROM</span> a <span class="keyword">as</span> ta <span class="keyword">WHERE</span> <span class="number">1</span>=<span class="number">1</span> <span class="keyword">AND</span> ta.<span class="string">`name`</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> <span class="string">`name`</span> <span class="keyword">FROM</span> b  <span class="keyword">WHERE</span> <span class="string">`name`</span> = <span class="string">'lisi'</span>)</span><br></pre></td></tr></table></figure><p>此处需要注意,子查询中的表不能使用正在删除的表,如上待删除的a表后面的子查询不能为a表,如果一定要使用a表,语法则改为:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> ta.* <span class="keyword">FROM</span> a <span class="keyword">as</span> ta <span class="keyword">WHERE</span> ta.<span class="string">`name`</span> <span class="keyword">in</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="string">`name`</span> <span class="keyword">FROM</span> a  <span class="keyword">WHERE</span> <span class="string">`name`</span> = <span class="string">'wangwu'</span>) t)</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;UPDATE&quot;&gt;&lt;a href=&quot;#UPDATE&quot; class=&quot;headerlink&quot; title=&quot;UPDATE&quot;&gt;&lt;/a&gt;UPDATE&lt;/h3&gt;&lt;p&gt;当update语句中,修改参数的值为实时查询出来的值，会报语法错误，譬如如下语法:&lt;br&gt;&lt;figure c
      
    
    </summary>
    
      <category term="数据库" scheme="http://www.assd.xyz/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
      <category term="mysql" scheme="http://www.assd.xyz/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>测试</title>
    <link href="http://www.assd.xyz/2018/04/04/1/"/>
    <id>http://www.assd.xyz/2018/04/04/1/</id>
    <published>2018-04-04T08:59:35.152Z</published>
    <updated>2018-04-04T09:40:40.658Z</updated>
    
    <content type="html"><![CDATA[<p>&emsp;&emsp;经过两周的调试，从无到有，gitHub上的博客终于搭建起来了，看到如今的成果还是挺开心的，果然是成功不负有心人呐，以后的日子里须要更加的努力！！<br><br><br><img src="./images/preview/preview1.jpg" alt="" title="美不美"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&amp;emsp;&amp;emsp;经过两周的调试，从无到有，gitHub上的博客终于搭建起来了，看到如今的成果还是挺开心的，果然是成功不负有心人呐，以后的日子里须要更加的努力！！&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;./images/preview/preview1.jpg&quot; 
      
    
    </summary>
    
      <category term="日常" scheme="http://www.assd.xyz/categories/%E6%97%A5%E5%B8%B8/"/>
    
    
      <category term="日常" scheme="http://www.assd.xyz/tags/%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
</feed>
